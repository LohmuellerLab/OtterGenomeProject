#!/bin/bash
#$ -cwd
#$ -l h_rt=5:00:00,h_data=28G,highp
#$ -N pbraMSMC1
#$ -m abe
#$ -M ab08028
rundate=`date +%Y%m%d`
model=pbra.msmc.full.8.644114e-09
mkdir -p ${model}
for j in {1..6}
do
mkdir -p ${model}/group_$j.${model}
cd ${model}/group_$j.${model}
cp ../../../macs ./
cp ../../../msformatter ./
for i in {1..10}
do
# giant otter msmc model -- full msmc
mu=8.644114e-09
r=1e-08
Na=304101.425691
rho=0.0121640570277
theta=0.010514749565
date=`date +%Y%m%d`
SEED=$((date+$RANDOM+((j-1)*10)+i))
# this is a new addition! need to have a different random seed for each simulation; if they start within a second of each other, they will have the same seed. not an issue for big simulations of 30Mb because those are slow, but 100kb can start within a second of each other!
./macs 2 30000000 -t 0.010514749565 -r 0.0121640570277 -s $SEED -eN 0.0 0.0068324407039 -eN 0.000700852640805 0.00774075792352 -eN 0.001419910185 0.0220724364055 -eN 0.0021581493558 0.0360314606827 -eN 0.0029166077433 0.0475071182377 -eN 0.0036964456224 0.0560984241867 -eN 0.0044988803307 0.0617890695045 -eN 0.00532527186255 0.0650874635569 -eN 0.00617710384815 0.0668258184194 -eN 0.0070559740431 0.0677008773647 -eN 0.007963670412 0.0681427849806 -eN 0.0089021425971 0.0681427849806 -eN 0.009873558981 0.0678300406533 -eN 0.0108802401135 0.0678300406533 -eN 0.0119250581505 0.066663512391 -eN 0.0130107711225 0.066663512391 -eN 0.0141408027915 0.0649960532655 -eN 0.0153189573375 0.0649960532655 -eN 0.0165494193585 0.0631743090014 -eN 0.017837229393 0.0631743090014 -eN 0.0191878083975 0.0614590502409 -eN 0.0206077185825 0.0614590502409 -eN 0.0221044732035 0.0601019979335 -eN 0.02368672677 0.0601019979335 -eN 0.025364940777 0.0594698615875 -eN 0.0271514788095 0.0594698615875 -eN 0.0290613673785 0.0602092981295 -eN 0.031112866548 0.0602092981295 -eN 0.033328611189 0.0635487384402 -eN 0.035737227756 0.0635487384402 -eN 0.0383757118995 0.0722228550599 -eN 0.041292281601 0.0722228550599 -eN 0.0445527491745 0.093681939745 -eN 0.048249175776 0.093681939745 -eN 0.0525164195865 0.153645888026 -eN 0.057563520297 0.153645888026 -eN 0.0637406526765 0.376573933289 -eN 0.0717043230885 0.376573933289 -eN 0.082928461074 1.0 -eN 0.102116554785 1.0  > group_${j}_block_${i}.${model}.macsFormat.OutputFile.${rundate}.txt 
./msformatter < group_${j}_block_${i}.${model}.macsFormat.OutputFile.${rundate}.txt > group_${j}_block_${i}.${model}.msFormat.OutputFile.${rundate}.txt
done
cd ../../
done
